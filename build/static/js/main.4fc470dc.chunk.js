(this.webpackJsonphktransit=this.webpackJsonphktransit||[]).push([[0],[,,,,,function(t,e,n){t.exports={routeOuter:"RouteIcon_routeOuter__T_UbS",Citybus:"RouteIcon_Citybus__1WSCb",KMB:"RouteIcon_KMB__1LHkN",NWFB:"RouteIcon_NWFB__kt2Dp",GMB:"RouteIcon_GMB__3QS4z",Cityflyer:"RouteIcon_Cityflyer__2AwOe",CityflyerOvernight:"RouteIcon_CityflyerOvernight__1z2aO",LWB:"RouteIcon_LWB__1LRKL",LWBOvernight:"RouteIcon_LWBOvernight__3UNrJ",Default:"RouteIcon_Default__KppCM",margins:"RouteIcon_margins__2k5cP",boxShadow:"RouteIcon_boxShadow__iL9tg"}},,function(t,e,n){t.exports={routeHolder:"RouteDisplayer_routeHolder__2QWOV",routeText:"RouteDisplayer_routeText__3MWxk",Citybus:"RouteDisplayer_Citybus__zxwGw",KMB:"RouteDisplayer_KMB__21Whg",NWFB:"RouteDisplayer_NWFB__2M607",GMB:"RouteDisplayer_GMB__uc9QW",Cityflyer:"RouteDisplayer_Cityflyer__1QI_2",CityflyerOvernight:"RouteDisplayer_CityflyerOvernight__Ga5xH",LWB:"RouteDisplayer_LWB__2z2YR",LWBOvernight:"RouteDisplayer_LWBOvernight__DYHBu",Default:"RouteDisplayer_Default__3UtTX",routeCompany:"RouteDisplayer_routeCompany__1DIiD"}},,,,,,,,,,function(t,e,n){t.exports={header:"Navigation_header__1bq3P",outerCircle:"Navigation_outerCircle__2CaYP",whiteCircle:"Navigation_whiteCircle__2sTPM",pulsingCircle:"Navigation_pulsingCircle__23HKV",pulse:"Navigation_pulse__2TcfW",headerTitle:"Navigation_headerTitle__hjU0u",headerRegion:"Navigation_headerRegion__3jom-"}},function(t,e,n){t.exports={stopHolder:"DisplayStop_stopHolder__22zeM",stopHolderButton:"DisplayStop_stopHolderButton__2sEJv",stopNumber:"DisplayStop_stopNumber__2gdfo",stopName:"DisplayStop_stopName__3c5hF"}},,,,function(t,e,n){t.exports={moreStopsButton:"MoreStops_moreStopsButton__s-pkf",moreStopsIcon:"MoreStops_moreStopsIcon__1AziM",loadingGif:"MoreStops_loadingGif__Y3DE8",moreStopsText:"MoreStops_moreStopsText__1rOIt",overrideText:"MoreStops_overrideText__1QNHS"}},function(t,e,n){t.exports={arrivalsItemHolder:"ArrivalsItem_arrivalsItemHolder__kO5ef",destination:"ArrivalsItem_destination__3xxiN",timeUntilArrival:"ArrivalsItem_timeUntilArrival__1DSFv"}},,,,function(t,e,n){t.exports={backButtonHolder:"BackButton_backButtonHolder__2bj1Z",backButtonIcon:"BackButton_backButtonIcon__33TK2",backButtonText:"BackButton_backButtonText__3F9yO"}},function(t,e,n){t.exports={chooseCompanyTitle:"ChooseCompany_chooseCompanyTitle__2Gb0N",chooseCompanySubtitle:"ChooseCompany_chooseCompanySubtitle__3XxHz",routeButton:"ChooseCompany_routeButton__1jfiY"}},function(t,e,n){t.exports={chooseCompanyTitle:"ChooseRoute_chooseCompanyTitle__xji5q",chooseCompanySubtitle:"ChooseRoute_chooseCompanySubtitle__2ILPP",routeButton:"ChooseRoute_routeButton__2BqHU"}},function(t,e,n){t.exports={noPadding:"BusStop_noPadding__3v-u5",stopMapPadding:"BusStop_stopMapPadding__2Wn01",minibusNotice:"BusStop_minibusNotice__1LAZL"}},,function(t,e,n){t.exports={pageTitle:"Title_pageTitle__1-a0d",pageSubtitle:"Title_pageSubtitle__ILwvf"}},function(t,e,n){t.exports={routeInputTag:"RouteInput_routeInputTag__3Rpj9",submitRouteButton:"RouteInput_submitRouteButton__vqR8D"}},function(t,e,n){t.exports={supportedRoutesTitle:"SupportedRoutes_supportedRoutesTitle__1fNB5",supportedRoutesHolder:"SupportedRoutes_supportedRoutesHolder__2DGs9"}},,,function(t,e,n){t.exports={loadingIcon:"Loading_loadingIcon__YNGry",loadingText:"Loading_loadingText__3mq4j"}},function(t,e,n){t.exports={stopDisplayerHolder:"Subsection_stopDisplayerHolder__2glMc",stopDisplayerSubtitle:"Subsection_stopDisplayerSubtitle__1rk1N"}},function(t,e,n){t.exports={stopMapHolder:"RouteMap_stopMapHolder__2rvyv",mapContainer:"RouteMap_mapContainer__1-OwI"}},function(t,e,n){t.exports={stopMapHolder:"StopMap_stopMapHolder__2jqcW",mapContainer:"StopMap_mapContainer__76gDW"}},function(t,e,n){t.exports={arrivalsTitleName:"ArrivalsTitle_arrivalsTitleName__3FU45",arrivalsTitleText:"ArrivalsTitle_arrivalsTitleText__1zWiw"}},,function(t,e,n){t.exports={attribution:"Attribution_attribution__dsVwZ"}},,,,,,,,,,,function(t,e,n){},,,,,,,function(t,e,n){"use strict";n.r(e);var a=n(1),o=n(25),r=n.n(o),s=n(12),i=(n(54),n(4)),c=n(17),u=n.n(c),l=n(0);var b=function(){return Object(l.jsxs)("header",{className:u.a.header,children:[Object(l.jsx)("span",{className:u.a.outerCircle}),Object(l.jsx)("span",{className:u.a.whiteCircle}),Object(l.jsx)("span",{className:u.a.pulsingCircle}),Object(l.jsx)("span",{className:u.a.headerTitle,children:"LiveTransit"}),Object(l.jsx)("span",{className:u.a.headerRegion,children:"HK"})]})};var d=function(t){return Object(l.jsxs)("div",{children:[Object(l.jsx)(b,{}),Object(l.jsx)("main",{children:t.children})]})},p=n(32),h=n.n(p);var j=function(t){return Object(l.jsxs)("div",{children:[Object(l.jsx)("span",{className:h.a.pageTitle,children:t.PageTitle}),void 0!==t.PageSubtitle?Object(l.jsx)("span",{className:h.a.pageSubtitle,children:t.PageSubtitle}):null]})},f=n(33),v=n.n(f);var m=function(t){return Object(l.jsxs)("div",{children:[Object(l.jsx)("input",{type:"text",placeholder:t.ExampleRoute,className:v.a.routeInputTag,onChange:t.Update,autoFocus:!0}),Object(l.jsx)("span",{className:v.a.submitRouteButton,onClick:t.Click,children:"Go"})]})},_=n(34),O=n.n(_),g=n(5),x=n.n(g),N={Cityflyer:["Citybus",["A10","A11","A12","A17","A20","A21","A22","A23","A26","A29","A29P"]],"Cityflyer (Overnight)":["Citybus",["NA10","NA11","NA12","NA20","NA21","NA29"]],"Long Win Bus":["KMB",["A31","A32","A33","A33X","A34","A36","A37","A38","A41","A41P","A43","A43P","A47X","E31","E32","E32A","E33","E33P","E36","E36A","E36P","E37","E41","E42","E42P","E43","S1","S64","S64C","S64P","S64X","S65","R8","R33","R42"]],"Long Win Bus (Overnight)":["KMB",["NA31","NA32","NA33","NA36","NA37","NA40","NA41","NA43","NA47"]]},y=function(t,e){for(var n=Object.keys(N),a=0;a<n.length;a++){var o=n[a];if(N[o][0]===e)for(var r=N[o][1],s=0;s<r.length;s++){if(r[s]===t)return o}}return!1},w=function(t){var e,n=t.Company,a=y(t.Route,n);if(!1===a)switch(t.Company){case"Citybus":e=x.a.Citybus;break;case"KMB":e=x.a.KMB;break;case"NWFB":e=x.a.NWFB;break;case"Green Minibus (NT)":case"Green Minibus (KLN)":case"Green Minibus (HKI)":e=x.a.GMB;break;default:e=x.a.Default}else switch(n=a,a){case"Cityflyer":e=x.a.Cityflyer;break;case"Cityflyer (Overnight)":e=x.a.CityflyerOvernight;break;case"Long Win Bus":e=x.a.LWB;break;case"Long Win Bus (Overnight)":e=x.a.LWBOvernight;break;default:e=x.a.Default}"Cityflyer"===t.Route?e=x.a.Cityflyer:"Long Win Bus"===t.Route&&(e=x.a.LWB);var o=void 0!==t.Margins?x.a.margins:null,r=void 0!==t.BoxShadow?x.a.boxShadow:null;return Object(l.jsx)("span",{className:e+" "+x.a.routeOuter+" "+r+" "+o,children:t.Route})},C=function(){return Object(l.jsxs)("div",{children:[Object(l.jsx)("span",{className:O.a.supportedRoutesTitle,children:"Supported Companies"}),Object(l.jsx)("span",{className:O.a.supportedRoutesHolder,children:["KMB","Long Win Bus","Citybus","Cityflyer","NWFB","Green Minibus (HKI)","Green Minibus (KLN)","Green Minibus (NT)"].map((function(t){return Object(l.jsx)(w,{Company:t,Route:t,Margins:"true",BoxShadow:"true"},"supported company ".concat(t))}))})]})},B=n(43),k=n.n(B);var S=function(t){return Object(l.jsx)("div",{children:Object(l.jsx)("span",{className:k.a.attribution,children:t.Text})})};var T=function(){document.title="Buses | LiveTransit HK",window.clearInterval(window.refreshInterval);var t=Object(i.g)();return Object(l.jsxs)("div",{children:[Object(l.jsx)(j,{PageTitle:"Live Bus Timetables",PageSubtitle:"Enter a route number to see stops and live arrival times of both buses and minibuses."}),Object(l.jsx)(m,{ExampleRoute:void 0===window.route?"40":window.route,Click:function(){void 0!==window.route&&""!==window.route||(window.route="40"),t.push("/buses/stops#"+window.route)},Update:function(t){var e=t.target.value.trim();""!==e&&(window.route=e)}.bind(this)}),Object(l.jsx)(C,{}),Object(l.jsx)(S,{Text:"Data courtesy of Citybus Limited, New World First Bus Services Limited, The Kowloon Motor Bus Company and the Government of Hong Kong."})]})},R=n(3),M=n(73),I=n(27),A=n.n(I);var D=function(t){var e=t.Text;return void 0===e&&(e="Back"),Object(l.jsx)("div",{children:Object(l.jsxs)(s.b,{to:t.Route,className:A.a.backButtonHolder,children:[Object(l.jsx)(M.a,{className:A.a.backButtonIcon}),Object(l.jsx)("span",{className:A.a.backButtonText,children:e})]})})},L=n(7),W=n.n(L);var H=function(t){var e,n=t.Company,a=y(t.Route,n);if(!1===a)switch(t.Company){case"Citybus":e=W.a.Citybus;break;case"KMB":e=W.a.KMB;break;case"NWFB":e=W.a.NWFB;break;case"Green Minibus (NT)":case"Green Minibus (KLN)":case"Green Minibus (HKI)":e=W.a.GMB;break;default:e=W.a.Default}else switch(n=a,a){case"Cityflyer":e=W.a.Cityflyer;break;case"Cityflyer (Overnight)":e=W.a.CityflyerOvernight;break;case"Long Win Bus":e=W.a.LWB;break;case"Long Win Bus (Overnight)":e=W.a.LWBOvernight;break;default:e=W.a.Default}var o="Default"!==n?n:"Not Found";return Object(l.jsxs)("div",{className:W.a.routeHolder,children:[Object(l.jsx)("span",{className:"".concat(W.a.routeText," ").concat(e),children:t.Route}),Object(l.jsx)("span",{className:W.a.routeCompany,children:void 0!==t.OverrideText?t.OverrideText:o})]})},K=n(37),P=n.n(K),G=n.p+"static/media/loading.c99116b2.gif";var E=function(){return Object(l.jsxs)("div",{children:[Object(l.jsx)("img",{src:G,alt:"Loading...",className:P.a.loadingIcon}),Object(l.jsx)("span",{className:P.a.loadingText,children:"Loading..."})]})},F=n(28),U=n.n(F);var z=function(t){var e=t.Companies;return Object(l.jsxs)("div",{children:[Object(l.jsx)("span",{className:U.a.chooseCompanyTitle,children:"Choose a company"}),Object(l.jsx)("h4",{className:U.a.chooseCompanySubtitle,children:"Multiple companies operate this route."}),e.map((function(e,n){return Object(l.jsx)("div",{children:Object(l.jsx)("button",{className:U.a.routeButton,onClick:function(){return t.ClickFunction(e)},children:Object(l.jsx)(H,{Route:t.Route,Company:e})})},n)}))]})},q=n(29),X=n.n(q);var Y=function(t){var e=t.Routes;return Object(l.jsxs)("div",{children:[Object(l.jsx)("span",{className:X.a.chooseCompanyTitle,children:"Choose a route"}),Object(l.jsx)("h4",{className:X.a.chooseCompanySubtitle,children:"This route operates with different paths."}),e.map((function(e){return Object(l.jsx)("div",{children:Object(l.jsx)("button",{className:X.a.routeButton,onClick:function(){return t.ClickFunction(e.route_id)},children:Object(l.jsx)(H,{Route:t.Route,Company:"Green Minibus (HKI)",OverrideText:e.description_en})})},e.route_id)}))]})},Q=n(18),Z=n.n(Q);var J=function(t){return Object(l.jsx)("div",{children:void 0!==t.Click?Object(l.jsxs)("button",{className:Z.a.stopHolderButton,onClick:t.Click,children:[Object(l.jsx)("span",{className:Z.a.stopNumber,children:t.Number}),Object(l.jsx)("span",{className:Z.a.stopName,children:t.StopName})]},t.Number):Object(l.jsxs)("div",{className:Z.a.stopHolder,children:[Object(l.jsx)("span",{className:Z.a.stopNumber,children:t.Number}),Object(l.jsx)("span",{className:Z.a.stopName,children:t.StopName})]},t.Number)})},V=n(38),$=n.n(V);var tt=function(t){return Object(l.jsxs)("div",{className:$.a.stopDisplayerHolder,children:[Object(l.jsx)("span",{className:$.a.stopDisplayerSubtitle,children:t.Subtitle}),Object(l.jsx)("div",{children:t.children})]})},et=n(74),nt=n(22),at=n.n(nt);var ot=function(t){return Object(l.jsx)("div",{children:null===t.OverrideText?Object(l.jsxs)("button",{className:at.a.moreStopsButton,onClick:t.ClickFunction,children:[!0===t.IsLoading?Object(l.jsx)("img",{src:G,alt:"Loading...",className:at.a.loadingGif}):Object(l.jsx)(et.a,{className:at.a.moreStopsIcon}),Object(l.jsxs)("span",{className:at.a.moreStopsText,children:[t.Number," More"]})]}):Object(l.jsx)("span",{className:at.a.overrideText,children:t.OverrideText})})},rt=n(75),st=n(76),it=n(79),ct=n(77),ut=n(78),lt=n(39),bt=n.n(lt),dt=function(){return Object(rt.a)().attributionControl._container.offsetParent.className="leaflet-top leaflet-right",null};var pt=function(t){var e=t.Coordinates;return Object(l.jsx)("div",{className:bt.a.stopMapHolder,children:Object(l.jsxs)(st.a,{zoom:12,center:e[0],scrollWheelZoom:!0,className:bt.a.mapContainer,children:[Object(l.jsx)(dt,{}),Object(l.jsx)(it.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",position:"topright"}),e.map((function(e,n){return Object(l.jsx)(ct.a,{position:e,children:Object(l.jsx)(ut.a,{children:"".concat(n+1,": ").concat(e[2])},"popup".concat(t.Ids[n]))},"marker".concat(t.Ids[n]))}))]})})},ht=function(t){return new Promise((function(e,n){var a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="json",a.onload=function(){e(a.response)},a.onerror=function(){n(a.response)},a.send()}))},jt=function(t){return Array.isArray(t)?0===t.length:t&&t.constructor===Object&&0===Object.keys(t).length},ft=function(t){return new Promise((function(e,n){var a=[],o=new Array(6),r=function(){(function(t){for(var e=0;e<t.length;e++)if(!0!==t[e])return!1;return!0})(o)&&(0===a.length&&a.push("Default"),e(a))};ht("https://data.etabus.gov.hk/v1/transport/kmb/route/".concat(t,"/outbound/1")).then((function(t){var e=t.data;jt(e)||a.push("KMB"),o[0]=!0,r()})),ht("https://rt.data.gov.hk/v1/transport/citybus-nwfb/route/CTB/".concat(t)).then((function(t){var e=t.data;jt(e)||a.push("Citybus"),o[1]=!0,r()})),ht("https://rt.data.gov.hk/v1/transport/citybus-nwfb/route/NWFB/".concat(t)).then((function(t){var e=t.data;jt(e)||a.push("NWFB"),o[2]=!0,r()})),ht("https://data.etagmb.gov.hk/route/NT/".concat(t)).then((function(t){var e=t.data;jt(e)||a.push("Green Minibus (NT)"),o[3]=!0,r()})),ht("https://data.etagmb.gov.hk/route/KLN/".concat(t)).then((function(t){var e=t.data;jt(e)||a.push("Green Minibus (KLN)"),o[4]=!0,r()})),ht("https://data.etagmb.gov.hk/route/HKI/".concat(t)).then((function(t){var e=t.data;jt(e)||a.push("Green Minibus (HKI)"),o[5]=!0,r()}))}))},vt=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"outbound",a=new Promise((function(a){var o;switch(e){case"KMB":o="https://data.etabus.gov.hk/v1/transport/kmb/route/".concat(t,"/").concat(n,"/1");break;case"Citybus":o="https://rt.data.gov.hk/v1/transport/citybus-nwfb/route/CTB/".concat(t);break;case"NWFB":o="https://rt.data.gov.hk/v1/transport/citybus-nwfb/route/NWFB/".concat(t);break;case"Green Minibus (NT)":o="https://data.etagmb.gov.hk/route/NT/".concat(t);break;case"Green Minibus (KLN)":o="https://data.etagmb.gov.hk/route/KLN/".concat(t);break;case"Green Minibus (HKI)":o="https://data.etagmb.gov.hk/route/HKI/".concat(t);break;case"Default":a("Route not found");break;default:o="https://data.etabus.gov.hk/v1/transport/kmb/route/".concat(t,"/outbound/1")}ht(o).then((function(t){a(t)}))}));return a},mt=function(t){return new Promise((function(e,n){ht("https://data.etagmb.gov.hk/route/".concat(t)).then((function(t){e(t.data[0])}))}))},_t=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"outbound",a=new Promise((function(a){var o;switch(e){case"KMB":o="https://data.etabus.gov.hk/v1/transport/kmb/route-stop/".concat(t,"/").concat(n,"/1");break;case"Citybus":o="https://rt.data.gov.hk/v1/transport/citybus-nwfb/route-stop/CTB/".concat(t,"/").concat(n);break;case"NWFB":o="https://rt.data.gov.hk/v1/transport/citybus-nwfb/route-stop/NWFB/".concat(t,"/").concat(n);break;case"Default":a("Route not found");break;default:o="https://data.etabus.gov.hk/v1/transport/kmb/route/".concat(t,"/").concat(n,"/1")}ht(o).then((function(t){jt(t.data)?a(-1):a(t.data)}))}));return a},Ot=function(t){return new Promise((function(e,n){ht("https://data.etagmb.gov.hk/route-stop/".concat(t,"/1")).then((function(t){e(t.data.route_stops)}))}))},gt=function(t,e){return new Promise((function(n){var a=new Array(t.length),o=new Array(t.length);t.forEach((function(t,r){ht(function(t,e){switch(t){case"KMB":return"https://data.etabus.gov.hk/v1/transport/kmb/stop/".concat(e);case"Citybus":case"NWFB":return"https://rt.data.gov.hk/v1/transport/citybus-nwfb/stop/".concat(e);case"Default":return"Route not found";default:return"https://data.etabus.gov.hk/v1/transport/kmb/stop/".concat(e)}}(e,t)).then((function(t){a[r]=t,o[r]=!0,function(t){for(var e=0;e<t.length;e++)if(!0!==t[e])return!1;return!0}(o)&&n(a)}))}))}))},xt=function(t){return new Promise((function(e){var n=new Array(t.length),a=new Array(t.length);t.forEach((function(t,o){ht("https://data.etagmb.gov.hk/stop/".concat(t)).then((function(r){n[o]=r,n[o].data.lat=r.data.coordinates.wgs84.latitude,n[o].data.long=r.data.coordinates.wgs84.longitude,ht("https://data.etagmb.gov.hk/stop-route/".concat(t)).then((function(t){n[o].data.name_en=t.data[0].name_en,a[o]=!0,function(t){for(var e=0;e<t.length;e++)if(!0!==t[e])return!1;return!0}(a)&&e(n)}))}))}))}))},Nt=function(t){for(var e=(t=t.toLowerCase()).split(" "),n=[],a=0;a<e.length;a++){var o=e[a];0!==o.length&&n.push(o[0].toUpperCase()+o.substring(1))}return n.join(" ").split("(").map((function(t){return t[0].toUpperCase()+t.substring(1)})).join("(")};var yt=function(){var t=Object(a.useState)(!0),e=Object(R.a)(t,2),n=e[0],o=e[1],r=Object(a.useState)("Default"),s=Object(R.a)(r,2),c=s[0],u=s[1],b=Object(a.useState)([!1]),d=Object(R.a)(b,2),p=d[0],h=d[1],j=Object(a.useState)(!0),f=Object(R.a)(j,2),v=f[0],m=f[1],_=Object(a.useState)([]),O=Object(R.a)(_,2),g=O[0],x=O[1],N=Object(a.useState)([]),y=Object(R.a)(N,2),w=y[0],C=y[1],B=Object(a.useState)([]),k=Object(R.a)(B,2),S=k[0],T=k[1],M=Object(a.useState)(0),I=Object(R.a)(M,2),A=I[0],L=I[1],W=Object(a.useState)(!1),K=Object(R.a)(W,2),P=K[0],G=K[1],F=Object(a.useState)(!1),U=Object(R.a)(F,2),q=U[0],X=U[1],Q=Object(a.useState)([!1]),Z=Object(R.a)(Q,2),V=Z[0],$=Z[1],et=Object(a.useState)(!1),nt=Object(R.a)(et,2),at=nt[0],rt=nt[1],st=Object(a.useState)(!0),it=Object(R.a)(st,2),ct=it[0],ut=it[1],lt=Object(a.useState)([]),bt=Object(R.a)(lt,2),dt=bt[0],ht=bt[1],yt=Object(a.useState)(0),wt=Object(R.a)(yt,2),Ct=wt[0],Bt=wt[1],kt=function(){var t=Object(a.useState)(0),e=Object(R.a)(t,2)[1];return function(){return e((function(t){return t+1}))}}();window.clearInterval(window.refreshInterval);var St=Object(i.g)(),Tt=function(){""===window.location.hash?St.push("/buses"):window.route=window.location.hash.substring(1).toUpperCase()};Tt();var Rt=function(){document.title="".concat(window.route," | Buses | LiveTransit HK")};Rt();var Mt=function(){o(!0),ft(window.route).then((function(t){1===t.length?(u(t[0]),It(t[0]),"Default"===t[0]?m(!1):m(!0)):(h(t),o(!1))}))};Object(a.useEffect)((function(){Mt()}),[]),window.addEventListener("hashchange",(function(){var t=(new Date).getTime();(void 0===window.lastHashChange||t-window.lastHashChange>200)&&(window.lastHashChange=t,Tt(),Rt(),kt(),Mt())}));var It=function(t){C([]),ut(!1),"Default"!==t&&(t.includes("Green Minibus")?(ut(!0),o(!0),rt(!0),G(!1),vt(window.route,t).then((function(t){if(1===t.data.length){var e=t.data[0].route_id;Bt(e),At(e)}else $(t.data),o(!1)}))):(o(!0),rt(!1),G(!1),vt(window.route,t).then((function(e){var n=e.data.orig_en,a=e.data.dest_en;"KMB"===t&&(n=Nt(n),a=Nt(a)),x([n,a]),_t(window.route,t).then((function(t){if(-1!==t){L(t.length-2);var e=[];t.forEach((function(t){e.push(t.stop)})),C(e),ut(!0),o(!1)}else ut(!1),o(!1)}))}))))},At=function(t){$([!1]),o(!0),mt(t).then((function(e){var n=e.directions[0].orig_en,a=e.directions[0].dest_en;x([n,a]),Ot(t).then((function(t){L(t.length-2);var e=[];t.forEach((function(t){e.push(t.stop_id)})),C(e),o(!1)}))}))};Object(a.useEffect)((function(){!1===n&&!1===P&&Dt()}),[P,n]);var Dt=function(){!0===ct&&(at?Lt():(G(!1),X(!0),gt(w,c).then((function(t){var e=[];t.forEach((function(t){return e.push([t.data.lat,t.data.long,t.data.name_en])})),ht(e),X(!1),T(t),G(!0)}))))},Lt=function(){G(!1),X(!0),xt(w).then((function(t){var e=[];t.forEach((function(t){return e.push([t.data.lat,t.data.long,t.data.name_en])})),ht(e),X(!1),T(t),G(!0)}))},Wt=function(t,e){return"KMB"===e?Nt(t):t};return window.targetedCapitalization=Wt,Object(l.jsxs)("div",{children:[Object(l.jsx)(D,{Route:"/buses"}),!1===n&&!1===p[0]&&!1===V[0]?Object(l.jsx)(H,{Company:c,Route:window.route}):null,n?Object(l.jsx)(E,{}):null,!1!==p[0]&&!1===n?Object(l.jsx)(z,{Companies:p,Route:window.route,ClickFunction:function(t){u(t),It(t),h([!1]),m(!0)}}):null,!1!==V[0]&&!1===n?Object(l.jsx)(Y,{Routes:V,Route:window.route,ClickFunction:At}):null,!1===n&&!1===p[0]&&!1===V[0]&&!0===v?Object(l.jsxs)(tt,{Subtitle:"Stops",children:[jt(dt)||n?null:Object(l.jsx)(pt,{Coordinates:dt,Ids:w}),P?Object(l.jsx)("div",{children:S.map((function(t,e){return Object(l.jsx)(J,{StopName:Wt(t.data.name_en,c),Number:e+1,StopId:w[e],Click:function(){return function(t){var e=S[t],n=w[t],a=c,o=window.route,r=e.data.name_en;"KMB"===a&&(r=Nt(r)),window.stopInformation={id:n,company:a,route:o,name:r,lat:e.data.lat,long:e.data.long,isMinibus:at,minibusRoute:Ct,destination:g[1]},St.push("/buses/stop")}(e)}},w[e])}))}):Object(l.jsxs)("div",{children:[Object(l.jsx)(J,{StopName:g[0],Number:"Origin"}),Object(l.jsx)(ot,{OverrideText:ct?null:"Stop information not available",Number:A,ClickFunction:ct?Dt:void 0,IsLoading:!!q}),Object(l.jsx)(J,{StopName:g[1],Number:"Destination"})]})]}):null]})},wt=n(30),Ct=n.n(wt),Bt=n(40),kt=n.n(Bt),St=function(){return Object(rt.a)().attributionControl._container.offsetParent.className="leaflet-top leaflet-right",null};var Tt=function(t){var e=[t.Lat,t.Long];return Object(l.jsx)("div",{className:kt.a.stopMapHolder,children:Object(l.jsxs)(st.a,{zoom:22,center:e,scrollWheelZoom:!0,className:kt.a.mapContainer,children:[Object(l.jsx)(St,{}),Object(l.jsx)(it.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object(l.jsx)(ct.a,{position:e,children:Object(l.jsx)(ut.a,{children:t.StopName})})]})})},Rt=n(41),Mt=n.n(Rt);var It=function(t){return Object(l.jsxs)("div",{children:[Object(l.jsx)("span",{className:Mt.a.arrivalsTitleName,children:t.StopName}),Object(l.jsxs)("span",{className:Mt.a.arrivalsTitleText,children:["Live",Object(l.jsx)(w,{Route:t.Route,Company:t.Company,BoxShadow:"true",Margins:"true"}),"Arrivals"]})]})},At=n(23),Dt=n.n(At),Lt=function(t){return Object(l.jsxs)("div",{className:Dt.a.arrivalsItemHolder,children:[Object(l.jsx)(w,{Route:t.Route,Company:t.Company,className:Dt.a.routeIcon}),Object(l.jsx)("span",{className:Dt.a.destination,children:t.Destination}),Object(l.jsx)("span",{className:Dt.a.timeUntilArrival,children:t.TimeUntilArrival})]})},Wt=function(t,e,n){return new Promise((function(a){ht(function(t,e,n){switch(t){case"KMB":return"https://data.etabus.gov.hk/v1/transport/kmb/eta/".concat(e,"/").concat(n,"/1");case"Citybus":return"https://rt.data.gov.hk/v1/transport/citybus-nwfb/eta/CTB/".concat(e,"/").concat(n);case"NWFB":return"https://rt.data.gov.hk/v1/transport/citybus-nwfb/eta/NWFB/".concat(e,"/").concat(n);case"Default":default:return"Route not found"}}(t,e,n)).then((function(t){a(t.data)}))}))},Ht=function(t,e){return new Promise((function(n){ht("https://crossrun.herokuapp.com/https://data.etagmb.gov.hk/eta/stop/".concat(t)).then((function(t){(t=t.data).forEach((function(t){t.route_id===e&&n(t.eta)}))}))}))},Kt=function(t){return new Date(t).getTime()},Pt=function(t){var e=(new Date).getTime(),n=Kt(t)-e;return n>6e4?["".concat(new Date(n).getUTCMinutes()," mins"),n]:n>0?["".concat(new Date(n).getUTCSeconds()," secs"),n]:["Now",n]},Gt=function(t){for(var e=new Array(t.length),n=0;n<t.length;n++){for(var a=t[n],o=Pt(a.eta)[1],r=0,s=0;s<t.length;s++){var i=t[s];o>Pt(i.eta)[1]&&r++}for(;void 0!==e[r];)r++;e[r]=a}return e};var Et=function(){var t=Object(a.useState)(window.stopInformation),e=Object(R.a)(t,1)[0],n=Object(a.useState)(!0),o=Object(R.a)(n,2),r=o[0],s=o[1],c=Object(a.useState)([]),u=Object(R.a)(c,2),b=u[0],d=u[1],p=Object(a.useState)(0),h=Object(R.a)(p,2),j=h[0],f=h[1],v=Object(i.g)(),m=function(){!0!==e.isMinibus?(0===j||(new Date).getTime()-j>=2e4)&&(Wt(e.company,e.id,e.route).then((function(t){var e=[];t.forEach((function(t){e.push(t)})),e=Gt(e),d(e),jt(e)&&clearInterval(window.refreshInterval),s(!1)})),f((new Date).getTime())):_()},_=function(){(0===j||(new Date).getTime()-j>=2e4)&&(Ht(e.id,e.minibusRoute).then((function(t){var n=[];t.forEach((function(t,a){n.push(t),n[a].dest_en=e.destination,n[a].eta=t.timestamp})),n=Gt(n),d(n),jt(n)&&clearInterval(window.refreshInterval),s(!1)})),f((new Date).getTime()))};return Object(a.useEffect)((function(){void 0!==e&&(m(),window.refreshInterval=setInterval(m,500))}),[]),void 0===e?(v.push("/buses"),Object(l.jsx)("h1",{children:"No stop specified"})):Object(l.jsxs)("div",{className:Ct.a.noPadding,children:[Object(l.jsx)(Tt,{Lat:e.lat,Long:e.long,StopName:e.name}),Object(l.jsxs)("div",{className:Ct.a.stopMapPadding,children:[Object(l.jsx)(D,{Text:e.route,Route:"/buses/stops#".concat(e.route)}),Object(l.jsx)(It,{StopName:e.name,Route:e.route,Company:e.company}),r||!0!==e.isMinibus?null:Object(l.jsx)("span",{className:Ct.a.minibusNotice,children:"Please note that these times have not been tested and may be incorrect."}),jt(b)?Object(l.jsx)("div",{children:r?Object(l.jsx)(E,{}):Object(l.jsx)("h3",{children:"No departures soon"})}):b.map((function(t,n){return Object(l.jsx)(Lt,{Route:e.route,Company:e.company,Destination:Nt(t.dest_en),TimeUntilArrival:Pt(t.eta)[0]},"arrival".concat(n))}))]})]})};var Ft=function(){return Object(l.jsx)(j,{PageTitle:"Page Not Found",PageSubtitle:"Sorry, we couldn't find the page you were looking for."})};var Ut=function(){return document.title="LiveTransit HK",window.clearInterval(window.refreshInterval),Object(l.jsxs)("div",{children:[Object(l.jsx)(j,{PageTitle:"Live Transit Tracking",PageSubtitle:"Track bus and minibus routes live."}),Object(l.jsx)(s.b,{to:"/buses",children:"Live Bus Tracking"})]})};var zt=function(){return Object(l.jsx)(d,{children:Object(l.jsxs)(i.d,{children:[Object(l.jsx)(i.b,{path:"/",exact:!0,children:Object(l.jsx)(Ut,{})}),Object(l.jsx)(i.b,{path:"/buses",exact:!0,children:Object(l.jsx)(T,{})}),Object(l.jsx)(i.b,{path:"/buses/stops",exact:!0,children:Object(l.jsx)(yt,{})}),Object(l.jsx)(i.b,{path:"/buses/stop",exact:!0,children:Object(l.jsx)(Et,{})}),Object(l.jsx)(i.b,{path:"/404",exact:!0,children:Object(l.jsx)(Ft,{})}),Object(l.jsx)(i.a,{to:"/404"})]})})};r.a.render(Object(l.jsx)(s.a,{children:Object(l.jsx)(zt,{})}),document.getElementById("root"))}],[[61,1,2]]]);
//# sourceMappingURL=main.4fc470dc.chunk.js.map